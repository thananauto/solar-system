name: docker-meta-check
on:
    workflow_dispatch: 
    push:
        branches: 
          -  '*'
    pull_request:
        branches:
           - '*'  
jobs:
    docker-meta:
        runs-on: ubuntu-latest
        env:
            image: ${{ github.repository }}
        permissions: write-all
        steps:
          - name: Checkout Repository
            uses: actions/checkout@v4
            
          - name: Docker meta
            id: meta
            uses: docker/metadata-action@v5
            with:
              images: ${{ env.image }}
              tags: |
                type=ref,event=branch
                type=ref,event=pr
                type=semver,pattern={{version}}
                type=semver,pattern={{major}}.{{minor}}
          - name: check tag and label values
            run: |
                echo ${{ github.ref }}
                echo ${{ steps.meta.outputs.tags }}
                echo ${{ steps.meta.outputs.labels }}

          - name: Login to GitHub Container Registry
            uses: docker/login-action@v3
            with:
              registry: ghcr.io
              username: ${{ github.actor }}
              password: ${{ secrets.GITHUB_TOKEN }}

         
